{% extends "feed/layout.html" %} {% load static %} {% load crispy_forms_tags %}
{% block searchform %}


<form
  class="form-inline my-2 my-lg-0 ml-5"
  action="{% url 'search_posts' %}"
  method="get">
  <input name="p" type="text" placeholder="Search posts. hi." />
  <button class="btn btn-success my-2 my-sm-0 ml-4" type="submit">
    Search 
  </button>
</form>
{% endblock searchform %} {% block content %}
<br /><br />
<div class="container">
  <div class="row">
    <div class="col-sm-9 col-md-7 col-lg-5 mx-auto">
      <div class="card card-signin my-5">
        <div class="card-body">
          <h5 class="card-title text-center"><b>Post</b></h5>
          <form class="form-signin" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <fieldset class="form-group">
              <br />
              {{ form|crispy }}
                <br><h5 class="total">Total</h5><h1>$23.00</h1>
            </fieldset>
              <div class="form-group">

            <!-- <button
                class="btn btn-lg btn-primary btn-block text-uppercase"
                type="submit">Post</button>-->

                  <div id="paypal-button-container-P-1N273155E86601137MDO2KQA"></div>
                  <script src="https://www.paypal.com/sdk/js?client-id=AUsbaXnO5yOWjn0S8uT-2CBqtRUhd1E2Hal7XtRM9Vs2tjxN7VxkqVeP7dKWyKc6mOLJ4LQgdhOvtB9j&vault=true&intent=subscription"
                          data-sdk-integration-source="button-factory"></script>
                  <script>
                      paypal.Buttons({
                          style: {
                              shape: 'pill',
                              color: 'gold',
                              layout: 'vertical',
                              label: 'subscribe'
                          },
                          createSubscription: function (data, actions) {
                              return actions.subscription.create({
                                  /* Creates the subscription */
                                  plan_id: 'P-1N273155E86601137MDO2KQA'
                              });
                          },
                          onApprove: function (data, actions) {
                              alert(data.subscriptionID); // You can add optional success message for the subscriber here
                              window.alert('Thank you for your payment, continue and submit you ad now!');
                              location.href = '{% url 'posts-create' %}';
                          },
                          onError: function (err) {
                              // Show an error page here, when an error occurs
                              //  window.location.href = "/your-error-page-here";
                              window.alert('An Error Occured!');
                              location.href = '{% url 'home' %}';

                          },
                          onCancel: function (data, actions) {
                              // Show a cancel page or return to cart
                              window.alert('Your Payment Was Cancelled!');
                              location.href = '{% url 'home' %}';
                          },

                      }).render('#paypal-button-container-P-1N273155E86601137MDO2KQA'); // Renders the PayPal button
                  </script>


                  <br />
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
{% block jsfiles %}{% endblock jsfiles %}
